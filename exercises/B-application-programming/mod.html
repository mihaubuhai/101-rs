<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>B - Application programming - Rust 101 - Exercises</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../0-install/mod.html"><strong aria-hidden="true">1.</strong> 0 - Installation</a></li><li class="chapter-item expanded "><a href="../A1-language-basics/mod.html"><strong aria-hidden="true">2.</strong> A1 - Language basics</a></li><li class="chapter-item expanded "><a href="../A2-advanced-intro/mod.html"><strong aria-hidden="true">3.</strong> A2 - Advanced Syntax, Ownership, references</a></li><li class="chapter-item expanded "><a href="../A3-traits-generics/mod.html"><strong aria-hidden="true">4.</strong> A3 - Traits and generics</a></li><li class="chapter-item expanded "><a href="../B-application-programming/mod.html" class="active"><strong aria-hidden="true">5.</strong> B - Application programming</a></li><li class="chapter-item expanded "><a href="../C-concurrency-parallelism/mod.html"><strong aria-hidden="true">6.</strong> C - Concurrency & Parallelism</a></li><li class="chapter-item expanded "><a href="../D-trait-objects-patterns/mod.html"><strong aria-hidden="true">7.</strong> D - Trait objects and Rust patterns</a></li><li class="chapter-item expanded "><a href="../E-async-web/mod.html"><strong aria-hidden="true">8.</strong> E - Async and Rust for Web</a></li><li class="chapter-item expanded "><a href="../F-safe-unsafe/mod.html"><strong aria-hidden="true">9.</strong> F - Safe Unsafe Rust</a></li><li class="chapter-item expanded "><a href="../G-ffi/mod.html"><strong aria-hidden="true">10.</strong> G - FFI and Dynamic modules</a></li><li class="chapter-item expanded "><a href="../P-final-project/mod.html"><strong aria-hidden="true">11.</strong> P Final project</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust 101 - Exercises</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="module-b---application-programming"><a class="header" href="#module-b---application-programming">Module B - Application programming</a></h1>
<p><a href="/slides/B/">Slides</a> (or <a href="/slides/B-application-programming.pdf">pdf</a>)</p>
<p><em>Code written in this exercise has to adhere to the Rust API Guidelines. <a href="https://rust-lang.github.io/api-guidelines/checklist.html">A checklist can be found here.</a></em></p>
<h2 id="b1-serializing-and-deserializing-of-strings-with-serde-"><a class="header" href="#b1-serializing-and-deserializing-of-strings-with-serde-">B.1 Serializing and deserializing of <code>String</code>s with <code>serde</code> ⭐</a></h2>
<p><em>This exercise is adapted from the <a href="https://github.com/ferrous-systems/teaching-material/blob/main/assignments/serde-lifetimes.adoc">serde_lifetimes exercise</a> by Ferrous Systems</em></p>
<p>Open <code>exercises/B/1-my-serde-app/src/main.rs</code>. In there, you'll find some Rust code we will do this exercise with.</p>
<p>We used <code>todo!()</code> macros to mark places where you should put code to make the program run. Look at the <a href="https://docs.rs/serde_json/latest/serde_json/#functions"><code>serde_json</code></a> api for help.</p>
<details>
    <summary><b>Hint</b></summary>
Serde comes with two traits: `Serializable` and `Deserializable`. These traits can be `derive` d for your `struct` or `enum` types. Other `serde-*` crates use these traits to convert our data type from and to corresponding representation (`serde-json` to JSON, `serde-yaml` to YAML, etc.).
</details>
<blockquote>
<p><em><strong>How come <code>main</code> returns an <code>anyhow::Result&lt;()&gt;</code>?</strong></em>
By having <code>main</code> return a result, we can bubble errors up all the way to runtime. You can find more information about it in <a href="https://doc.rust-lang.org/rust-by-example/error/result.html#using-result-in-main">Rust By Example</a>. The <code>anyhow::Result</code> is a more flexible type of <code>Result</code>, which allows for easy conversion of error types.</p>
</blockquote>
<blockquote>
<p><em><strong>What is that <code>r#&quot;...</code> thing?</strong></em><br />
<code>r</code> in front of a string literal means it's a &quot;raw&quot; string. Escape sequences (<code>\n</code>, <code>\&quot;</code>, etc.) don't work, and thus they are very convenient for things like regular expressions, JSON literals, etc.</p>
<p>Optionally <code>r</code> can be followed by one or more symbols (like <code>#</code> in our case), and then your string ends when there's a closing double quote followed by the same number of the same symbols. This is great for cases when you want to have double quotes inside your string literal. For our example <code>r#&quot; ... &quot;#</code> works great for JSON. In rare cases you'd want to put two or more pound signs. Like, when you store CSS color values in your JSON strings:</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// here `&quot;#` would not terminate the string
r##&quot;
    {
        &quot;color&quot;: &quot;#ff00ff&quot;
    }
&quot;##
<span class="boring">}</span></code></pre></pre>
<h2 id="b2-your-first-rust-project"><a class="header" href="#b2-your-first-rust-project">B.2 Your first Rust project</a></h2>
<p>In this exercise, you will create a Rust crate that adheres to the guidelines that were pointed out during the lecture. Additionally, you will add and use dependencies, create unit tests, and create some documentation. You can view this exercise as a stepping stone to the final project.</p>
<p><em>This exercise should be done in groups of 2 people</em></p>
<h3 id="b2a-setting-up-"><a class="header" href="#b2a-setting-up-">B.2.A Setting up ⭐</a></h3>
<p>Create a new project using <code>cargo new --name quizzer</code>. Make sure it acts as both a binary and a library. That means there will be both a <code>src/lib.rs</code> and a <code>src/bin/quizzer/main.rs</code> file in your crate, where <code>quizzer</code> is the name of the binary:</p>
<pre><code class="language-bash">$ tree
.
├── Cargo.toml
├── quiz.json
└── src
    ├── bin
    │   └── quizzer
    │       └── main.rs
    └── lib.rs

</code></pre>
<p>Add the following dependencies to your <code>Cargo.toml</code> file. Below items contain links to their page on lib.rs. Make sure you get a general idea of what these crates are for and how they can be used. Don't dive too deep just yet.</p>
<ul>
<li><a href="https://lib.rs/crates/anyhow"><code>anyhow</code> 1.0</a></li>
<li><a href="https://lib.rs/crates/clap"><code>clap</code> 4.0</a> Also, skim over <a href="https://docs.rs/clap/latest/clap/_derive/_tutorial/index.html">https://docs.rs/clap/latest/clap/_derive/_tutorial/index.html</a></li>
<li><a href="https://lib.rs/crates/serde_json"><code>serde-json</code> 1.0</a></li>
<li><a href="https://lib.rs/crates/serde"><code>serde</code> 1.0</a></li>
</ul>
<p>Your <code>Cargo.toml</code> should look like this:</p>
<pre><code class="language-toml">[package]
name = &quot;quizzer&quot;
version = &quot;0.1.0&quot;
edition = &quot;2021&quot;

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
anyhow = &quot;1.0.66&quot;
clap = { version = &quot;4.0.18&quot;, features = [&quot;derive&quot;] }
serde = { version = &quot;1.0&quot;, features = [&quot;derive&quot;] }
serde_json = &quot;1.0.87&quot;
</code></pre>
<p>For <code>clap</code> and <code>serde</code>, the non-standard <code>derive</code> feature of each these crates is enabled. For <code>clap</code>, it allows us to derive the <code>Parser</code> trait, which greatly simplifies creating a CLI. The <code>derive</code> feaure from <code>serde</code> allows us to derive the <code>Serialize</code> and <code>Deserialize</code> traits on any struct we wish to serialize or deserialize using <code>serde</code> and its backends, in our case <code>serde_json</code>.</p>
<h3 id="b2b-quizzer-"><a class="header" href="#b2b-quizzer-">B.2.B Quizzer ⭐⭐⭐</a></h3>
<p>This exercise is about both design and finding information. You'll have to figure out a model to represent your quiz questions, as well as a means to store them into a JSON file, and load them yourself. Also, you will have to find out how to parse the program arguments.</p>
<p>We will use the project we just set up to write a quiz game creator and player. You may add other dependencies as needed. It has the following functional requirements:</p>
<ul>
<li>It runs as a command-line tool in your terminal.</li>
<li>It has two modes: question-entering mode and quiz mode. The mode is selected with a subcommand, passed as the first argument to the program.
<ul>
<li>Question-entering mode: Allows for entering multiple-choice quiz questions, with 4 possible answers each, exactly 1 of them being correct. The questions are stored on disk as a JSON file.</li>
<li>Quiz mode: Loads stored questions from the JSON file, presents the questions one-by-one to the player, reads and verifies the player input, and presents the score at the end of the game.</li>
</ul>
</li>
<li>Errors are correctly handled, i.e. your application does not panic if it encounters any unexpected situation. Use <code>anywhow</code> and the question-mark (<code>?</code>) operator to make error-bubbling concise. You can read about the <code>?</code>-operator here: <a href="https://doc.rust-lang.org/reference/expressions/operator-expr.html#the-question-mark-operator">https://doc.rust-lang.org/reference/expressions/operator-expr.html#the-question-mark-operator</a></li>
<li>Logic concerning creating, storing, and loading quiz questions is defined in the library part of your crate.</li>
<li>Functionality regarding user input (arg parsing, reading from stdin) is defined in the application code, not in your library.</li>
<li>Logical units of your crate are divided up into modules.</li>
</ul>
<p>Before you start coding, make sure you've listed all open questions and found answers to them. You're also encouraged to draw a simple diagram of the module structure of your application, annotating each module with its responsibilities.</p>
<h2 id="b3-fizzbuzz"><a class="header" href="#b3-fizzbuzz">B.3 FizzBuzz</a></h2>
<p>In this exercise, you will practise writing a unit test, and use Rusts benchmarking functionality to help you optimize a <a href="https://en.wikipedia.org/wiki/Fizz_buzz">FizzBuzz</a> app. You will need <a href="https://bheisler.github.io/criterion.rs/book/cargo_criterion/cargo_criterion.html"><code>cargo-criterion</code></a>, a tool that runs benchmarks and creates nice reports. You can install it by running</p>
<pre><code class="language-bash">cargo install cargo-criterion --version=1.1.0
</code></pre>
<h3 id="b3a-testing-fizz-buzz-"><a class="header" href="#b3a-testing-fizz-buzz-">B.3.A Testing Fizz Buzz ⭐</a></h3>
<p>Open <code>exercises/B3-fizzbuzz/src/lib.rs</code>. Create a unit test that verifies the correctness of the <code>fizz_buzz</code> function. You can use the <a href="https://doc.rust-lang.org/std/macro.include_str.html"><code>include_str</code></a> macro to include <code>exercises/B/3-fizzbuzz/fizzbuzz.out</code> as a <code>&amp;str</code> into your binary. Each line of <code>fizzbuzz.out</code> contains the expected output of the <code>fizz_buzz</code> function given the line number as input. You can run the test with</p>
<pre><code class="language-bash">cargo test
</code></pre>
<p>By default, Rusts test harness captures all output and discards it, If you like to debug your test code using print statements, you can run</p>
<pre><code class="language-bash">cargo test -- --nocapture
</code></pre>
<p>to prevent the harness from capturing output.</p>
<h3 id="b3b-benchmarking-fizz-buzz-"><a class="header" href="#b3b-benchmarking-fizz-buzz-">B.3.B Benchmarking Fizz Buzz ⭐⭐</a></h3>
<p>You'll probably have noticed the <code>fizz_buzz</code> implementation is not very optimized. We will use <code>criterion</code> to help us benchmark <code>fizz_buzz</code>. To run a benchmark, run the following command when in the <code>exercises/B/3-fizzbuzz/</code> directory:</p>
<pre><code class="language-bash">cargo criterion
</code></pre>
<p>This command will run the benchmarks, and report some statistics to your terminal. It also generates HTML reports including graphs that you can find under <code>target/criterion/reports</code>. For instance, <code>target/criterion/reports/index.html</code> is a summary of all benchmark. Open it with your browser and have a look.</p>
<p>Your job is to do some optimization of the <code>fizz_buzz</code> function, and use <code>cargo-criterion</code> to measure the impact of your changes. Don't be afraid to change the signature of <code>fizz_buzz</code>, if, for instance, you want to minimize the number of allocations done by this function. However, make sure that the function is able to correctly produce the output. How fast can you FizzBuzz?</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../A3-traits-generics/mod.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../C-concurrency-parallelism/mod.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../A3-traits-generics/mod.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../C-concurrency-parallelism/mod.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
